{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/Desktop/GOSSIP/src/app/chat/status/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useStatus } from \"@/contexts/status-context\";\nimport { useAuth } from \"@/contexts/auth-context\";\nimport { Plus, Radio, Loader2, Camera, X, Play, Pause } from \"lucide-react\";\nimport { Avatar } from \"@/components/ui/avatar\";\nimport { GradientText } from \"@/components/ui/gradient-text\";\nimport { useState, useEffect, useRef } from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport { ProfileService } from \"@/services/profile-service\";\nimport { useToast } from \"@/contexts/toast-context\";\n\nexport default function StatusPage() {\n    const { statuses, loading, uploadStatus, refreshStatuses } = useStatus();\n    const { user } = useAuth();\n    const { addToast } = useToast();\n    const [viewingUser, setViewingUser] = useState<any>(null);\n    const [currentIndex, setCurrentIndex] = useState(0);\n    const [progress, setProgress] = useState(0);\n    const [uploading, setUploading] = useState(false);\n    const fileInputRef = useRef<HTMLInputElement>(null);\n\n    // Group statuses by user\n    const userStatuses = statuses.reduce((acc: any, status: any) => {\n        const userId = status.user_id;\n        if (!acc[userId]) {\n            acc[userId] = {\n                user: status.profiles,\n                items: []\n            };\n        }\n        acc[userId].items.push(status);\n        return acc;\n    }, {});\n\n    const sortedUsers = Object.values(userStatuses);\n\n    // Status Viewer Logic\n    useEffect(() => {\n        let timer: any;\n        if (viewingUser) {\n            setProgress(0);\n            timer = setInterval(() => {\n                setProgress(prev => {\n                    if (prev >= 100) {\n                        if (currentIndex < viewingUser.items.length - 1) {\n                            setCurrentIndex(currentIndex + 1);\n                            return 0;\n                        } else {\n                            setViewingUser(null);\n                            return 0;\n                        }\n                    }\n                    return prev + 1;\n                });\n            }, 50); // 5 seconds per status (100 * 50ms)\n        }\n        return () => clearInterval(timer);\n    }, [viewingUser, currentIndex]);\n\n    const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (!file) return;\n\n        setUploading(true);\n        try {\n            if (!user) throw new Error(\"Not authenticated\");\n            const { data: url, error } = await ProfileService.uploadAvatar(user.id, file);\n            if (error) throw new Error(error);\n            if (url) {\n                await uploadStatus(url, \"\");\n                addToast(\"Whisper posted!\", \"success\");\n                refreshStatuses();\n            }\n        } catch (err: any) {\n            addToast(err.message || \"Failed to post whisper\", \"error\");\n        } finally {\n            setUploading(false);\n        }\n    };\n\n    const getNameColor = (gender?: string) => {\n        switch (gender?.toLowerCase()) {\n            case 'male': return '#00BFFF';\n            case 'female': return '#FFB6C1';\n            case 'other': return '#FFD700';\n            default: return '#FFF';\n        }\n    };\n\n    return (\n        <div className=\"flex-1 flex flex-col bg-black h-full relative overflow-hidden\">\n            {/* Background Decor */}\n            <div className=\"absolute top-0 right-0 w-[600px] h-[600px] bg-secondary/10 rounded-full blur-[150px] pointer-events-none\" />\n\n            {/* Header */}\n            <header className=\"p-8 pb-4 flex items-center justify-between relative z-10\">\n                <div className=\"flex items-center gap-6\">\n                    <div>\n                        <div className=\"flex items-center gap-4\">\n                            <GradientText text=\"Whispers\" className=\"text-5xl font-black italic uppercase tracking-tighter\" />\n                            <div className=\"w-16 h-16 relative\">\n                                <img src=\"/gossip_illustration.png\" alt=\"Whispers\" className=\"w-full h-full object-contain opacity-80\" />\n                            </div>\n                        </div>\n                        <p className=\"text-white/30 text-xs font-bold uppercase tracking-[0.2em] mt-1\">Disappearing stories of your circle.</p>\n                    </div>\n                </div>\n                <div className=\"flex gap-4\">\n                    <button\n                        onClick={() => fileInputRef.current?.click()}\n                        disabled={uploading}\n                        className=\"p-5 bg-white/5 border border-white/10 rounded-[24px] hover:bg-white/10 transition-all text-white disabled:opacity-50\"\n                    >\n                        {uploading ? <Loader2 className=\"w-8 h-8 animate-spin\" /> : <Camera className=\"w-8 h-8\" />}\n                    </button>\n                    <input\n                        type=\"file\"\n                        ref={fileInputRef}\n                        className=\"hidden\"\n                        accept=\"image/*\"\n                        onChange={handleFileSelect}\n                    />\n                </div>\n            </header>\n\n            {/* Content */}\n            <div className=\"flex-1 overflow-y-auto custom-scrollbar p-8 pt-4 relative z-10\">\n                {loading && !uploading ? (\n                    <div className=\"flex items-center justify-center h-64\">\n                        <Loader2 className=\"w-10 h-10 animate-spin text-secondary\" />\n                    </div>\n                ) : (\n                    <div className=\"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n                        {/* My Status Card */}\n                        <div\n                            onClick={() => fileInputRef.current?.click()}\n                            className=\"aspect-[3/4] rounded-[40px] bg-white/5 border border-dashed border-white/20 flex flex-col items-center justify-center gap-4 hover:border-secondary transition-all cursor-pointer group active:scale-95\"\n                        >\n                            <div className=\"w-20 h-20 rounded-[30px] bg-secondary/20 flex items-center justify-center text-secondary group-hover:scale-110 transition-all\">\n                                <Plus className=\"w-10 h-10\" />\n                            </div>\n                            <span className=\"text-[10px] font-black uppercase tracking-widest text-white/30 group-hover:text-secondary transition-colors\">Post Whisper</span>\n                        </div>\n\n                        {/* User Status Cards */}\n                        {sortedUsers.map((item: any) => (\n                            <div\n                                key={item.user.id}\n                                onClick={() => {\n                                    setViewingUser(item);\n                                    setCurrentIndex(0);\n                                    setProgress(0);\n                                }}\n                                className=\"aspect-[3/4] rounded-[40px] relative overflow-hidden border border-white/10 hover:border-secondary transition-all cursor-pointer group\"\n                            >\n                                <img\n                                    src={item.items[0].media_url}\n                                    alt=\"\"\n                                    className=\"absolute inset-0 w-full h-full object-cover group-hover:scale-110 duration-700 transition-all\"\n                                />\n                                <div className=\"absolute inset-0 bg-gradient-to-t from-black via-black/20 to-transparent\" />\n\n                                <div className=\"absolute top-6 left-6 right-6 flex gap-2\">\n                                    {item.items.map((_: any, idx: number) => (\n                                        <div key={idx} className=\"h-1 flex-1 bg-white/30 rounded-full overflow-hidden\">\n                                            {idx === 0 && <div className=\"h-full bg-secondary w-full\" />}\n                                        </div>\n                                    ))}\n                                </div>\n\n                                <div className=\"absolute bottom-6 left-6 flex items-center gap-3\">\n                                    <div className=\"relative p-1 rounded-full border-2 border-secondary bg-black ring-4 ring-black\">\n                                        <Avatar src={item.user.avatar_url} fallback={item.user.username?.[0] || \"?\"} className=\"w-10 h-10\" />\n                                    </div>\n                                    <div className=\"overflow-hidden\">\n                                        <p className=\"text-[14px] font-black uppercase text-white tracking-tight truncate italic\" style={{ color: getNameColor(item.user.gender) }}>\n                                            {item.user.username}\n                                        </p>\n                                        <p className=\"text-[9px] font-bold text-white/50 uppercase tracking-widest\">\n                                            {new Date(item.items[0].created_at).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                                        </p>\n                                    </div>\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                )}\n            </div>\n\n            {/* Status Viewer Modal */}\n            {viewingUser && (\n                <div className=\"fixed inset-0 bg-black z-[100] flex items-center justify-center p-4\">\n                    <div className=\"relative w-full max-w-lg aspect-[9/16] rounded-[40px] overflow-hidden bg-white/5 shadow-2xl animate-in zoom-in duration-300\">\n                        <img\n                            src={viewingUser.items[currentIndex].media_url}\n                            alt=\"\"\n                            className=\"absolute inset-0 w-full h-full object-contain md:object-cover\"\n                        />\n\n                        <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-black/60 pointer-events-none\" />\n\n                        {/* Progress Bars */}\n                        <div className=\"absolute top-8 left-8 right-8 flex gap-2 z-20\">\n                            {viewingUser.items.map((_: any, idx: number) => (\n                                <div key={idx} className=\"h-1 flex-1 bg-white/20 rounded-full overflow-hidden\">\n                                    {idx < currentIndex && <div className=\"h-full bg-white w-full\" />}\n                                    {idx === currentIndex && <div className=\"h-full bg-white transition-all duration-50\" style={{ width: `${progress}%` }} />}\n                                </div>\n                            ))}\n                        </div>\n\n                        {/* Header */}\n                        <div className=\"absolute top-14 left-8 right-8 flex items-center justify-between z-20\">\n                            <div className=\"flex items-center gap-4\">\n                                <Avatar src={viewingUser.user.avatar_url} fallback={viewingUser.user.username[0]} className=\"w-12 h-12 ring-2 ring-white/50\" />\n                                <div>\n                                    <p className=\"text-white font-black italic uppercase tracking-tight\" style={{ color: getNameColor(viewingUser.user.gender) }}>{viewingUser.user.username}</p>\n                                    <p className=\"text-white/50 text-[10px] uppercase font-bold tracking-widest\">{new Date(viewingUser.items[currentIndex].created_at).toLocaleTimeString()}</p>\n                                </div>\n                            </div>\n                            <button onClick={() => setViewingUser(null)} className=\"p-3 bg-black/20 hover:bg-black/40 rounded-full backdrop-blur-xl border border-white/10 text-white transition-all\">\n                                <X className=\"w-6 h-6\" />\n                            </button>\n                        </div>\n\n                        {/* Caption */}\n                        {viewingUser.items[currentIndex].caption && (\n                            <div className=\"absolute bottom-16 left-8 right-8 z-20 text-center\">\n                                <p className=\"text-white text-lg font-bold drop-shadow-lg\">{viewingUser.items[currentIndex].caption}</p>\n                            </div>\n                        )}\n\n                        {/* Tap Controls */}\n                        <div className=\"absolute inset-x-0 top-32 bottom-32 flex z-10\">\n                            <div\n                                className=\"flex-1 hover:bg-white/5 transition-all cursor-pointer\"\n                                onClick={() => {\n                                    if (currentIndex > 0) {\n                                        setCurrentIndex(currentIndex - 1);\n                                        setProgress(0);\n                                    }\n                                }}\n                            />\n                            <div\n                                className=\"flex-1 hover:bg-white/5 transition-all cursor-pointer\"\n                                onClick={() => {\n                                    if (currentIndex < viewingUser.items.length - 1) {\n                                        setCurrentIndex(currentIndex + 1);\n                                        setProgress(0);\n                                    } else {\n                                        setViewingUser(null);\n                                    }\n                                }}\n                            />\n                        </div>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}}]
}
module.exports=[86544,a=>{"use strict";var b=a.i(99881),c=a.i(84494),d=a.i(57120),e=a.i(42323),f=a.i(52053),g=a.i(70981);let h=(0,g.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var i=a.i(56381);let j=(0,g.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),k=(0,g.default)("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]);var l=a.i(6900);let m=(0,g.default)("check-check",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]),n=(0,g.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),o=(0,g.default)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var p=a.i(96496);let q=(0,g.default)("reply",[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]]);var r=a.i(83749),s=a.i(54720),t=a.i(65374),u=a.i(14359),v=a.i(74831),w=a.i(24262),x=a.i(82985),y=a.i(26486);function z({onClose:a,onVoiceCall:c,onVideoCall:d,onBlockUser:e,isBlocked:f,isGroup:g}){return(0,b.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-black/40 backdrop-blur-sm p-0 sm:p-4",children:[(0,b.jsxs)("div",{className:"w-full max-w-2xl bg-[#0A0A0A] border-t border-x border-white/10 rounded-t-[32px] sm:rounded-b-[32px] shadow-2xl overflow-hidden animate-in slide-in-from-bottom duration-300",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"p-6 flex items-center justify-between border-b border-white/5",children:[(0,b.jsxs)("h2",{className:"text-xl font-bold tracking-tighter",children:[(0,b.jsx)("span",{className:"text-primary font-black",children:"GOSSIP"})," ",(0,b.jsx)("span",{className:"text-secondary font-black",children:"ACTIONS"})]}),(0,b.jsx)("button",{onClick:a,className:"p-2 hover:bg-white/5 rounded-full transition-colors",children:(0,b.jsx)(u.X,{className:"w-6 h-6 text-white"})})]}),(0,b.jsxs)("div",{className:"p-4 space-y-3 pb-12",children:[(0,b.jsxs)("button",{onClick:c,className:"w-full flex items-center gap-4 p-4 bg-white/5 hover:bg-white/10 rounded-2xl transition-all group",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary group-hover:scale-110 transition-transform",children:(0,b.jsx)(v.Phone,{className:"w-5 h-5"})}),(0,b.jsx)("span",{className:"text-white font-bold text-[15px]",children:"Voice Call"})]}),(0,b.jsxs)("button",{onClick:d,className:"w-full flex items-center gap-4 p-4 bg-white/5 hover:bg-white/10 rounded-2xl transition-all group",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary group-hover:scale-110 transition-transform",children:(0,b.jsx)(w.Video,{className:"w-5 h-5"})}),(0,b.jsx)("span",{className:"text-white font-bold text-[15px]",children:"Video Call"})]}),(0,b.jsxs)("button",{className:"w-full flex items-center gap-4 p-4 bg-white/5 hover:bg-white/10 rounded-2xl transition-all group",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-xl bg-yellow-500/10 flex items-center justify-center text-yellow-500 group-hover:scale-110 transition-transform",children:(0,b.jsx)(x.Lock,{className:"w-5 h-5"})}),(0,b.jsx)("span",{className:"text-white font-bold text-[15px]",children:"Lock Chat"})]}),(0,b.jsxs)("button",{onClick:e,className:(0,r.cn)("w-full flex items-center gap-4 p-4 border rounded-2xl transition-all group",f?"bg-green-500/5 border-green-500/20 hover:bg-green-500/10":"bg-red-500/5 border-red-500/20 hover:bg-red-500/10"),children:[(0,b.jsx)("div",{className:(0,r.cn)("w-10 h-10 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform",f?"bg-green-500/10 text-green-500":"bg-red-500/10 text-red-500"),children:(0,b.jsx)(y.Ban,{className:"w-5 h-5"})}),(0,b.jsx)("span",{className:(0,r.cn)("font-bold text-[15px]",f?"text-green-500":"text-red-500"),children:f?"Unblock User":"Block User"})]})]})]}),(0,b.jsx)("div",{className:"absolute inset-0 -z-10",onClick:a})]})}var A=a.i(76728);function B({roomId:a,onClose:c,currentUserId:g}){let[h,i]=(0,d.useState)([]),[j,k]=(0,d.useState)(""),[l,m]=(0,d.useState)("ELLARUM VANGA ALWAYS WELCOME YOU"),[n,o]=(0,d.useState)(!1),[p,q]=(0,d.useState)(!0),[r,s]=(0,d.useState)(!1),[t,v]=(0,d.useState)(!1),[w,x]=(0,d.useState)(""),[y,z]=(0,d.useState)([]),[B,C]=(0,d.useState)(!1),D=(0,e.createClient)();(0,d.useEffect)(()=>{E()},[a]);let E=async()=>{let{data:b}=await D.from("rooms").select("*").eq("id",a).single();b&&(k(b.name||"Chat"),o(b.is_group));let{data:c}=await D.from("room_participants").select("role, profiles(*)").eq("room_id",a);if(c){let a=c.map(a=>({...a.profiles,role:a.role}));i(a);let b=a.find(a=>a.id===g);b&&("owner"===b.role||"admin"===b.role)&&s(!0)}q(!1)},F=async()=>{j.trim()&&await D.from("rooms").update({name:j}).eq("id",a)},G=async b=>{await D.from("room_participants").delete().eq("room_id",a).eq("user_id",b),i(a=>a.filter(a=>a.id!==b))};return p?null:t?(0,b.jsx)("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-black/40 backdrop-blur-sm",children:(0,b.jsxs)("div",{className:"w-full max-w-2xl bg-[#0A0A0A] border-t border-x border-white/10 rounded-t-[32px] shadow-2xl overflow-hidden animate-in slide-in-from-bottom duration-300 max-h-[80vh] flex flex-col",children:[(0,b.jsxs)("div",{className:"p-6 flex items-center justify-between border-b border-white/5",children:[(0,b.jsx)("button",{onClick:()=>v(!1),className:"text-primary font-bold",children:"Back"}),(0,b.jsxs)("h2",{className:"text-xl font-bold tracking-tighter",children:[(0,b.jsx)("span",{className:"text-primary font-black",children:"GROUP"})," ",(0,b.jsx)("span",{className:"text-secondary font-black",children:"MEMBERS"})]}),(0,b.jsx)("button",{onClick:c,className:"p-2 hover:bg-white/5 rounded-full transition-colors",children:(0,b.jsx)(u.X,{className:"w-6 h-6 text-white"})})]}),(0,b.jsx)("div",{className:"p-4 overflow-y-auto custom-scrollbar flex-1",children:(0,b.jsx)("div",{className:"space-y-3",children:h.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white/5 rounded-2xl",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(f.Avatar,{src:a.avatar_url||void 0,fallback:a.username||"?",className:"w-10 h-10"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-bold text-white",children:a.full_name||a.username}),(0,b.jsx)("p",{className:"text-[10px] text-white/40 uppercase font-black",children:a.role})]})]}),r&&g!==a.id&&(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)("button",{onClick:()=>G(a.id),className:"text-red-500 text-xs font-bold",children:"REMOVE"})})]},a.id))})})]})}):(0,b.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-black/40 backdrop-blur-sm p-0 sm:p-4",children:[(0,b.jsxs)("div",{className:"w-full max-w-2xl bg-[#0A0A0A] border-t border-x border-white/10 rounded-t-[32px] sm:rounded-b-[32px] shadow-2xl overflow-hidden animate-in slide-in-from-bottom duration-300",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"p-6 flex items-center justify-between",children:[(0,b.jsxs)("h2",{className:"text-xl font-bold tracking-tighter",children:[(0,b.jsx)("span",{className:"text-primary font-black",children:"GROUP"})," ",(0,b.jsx)("span",{className:"text-secondary font-black",children:"SETTINGS"})]}),(0,b.jsx)("button",{onClick:c,className:"p-1 px-[3px] border-2 border-primary rounded-md text-primary hover:bg-primary/10 transition-colors",children:(0,b.jsx)(u.X,{className:"w-4 h-4 text-primary",strokeWidth:4})})]}),(0,b.jsxs)("div",{className:"flex flex-col items-center p-6 pt-0 space-y-8",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,b.jsx)(f.Avatar,{src:h[0]?.avatar_url,fallback:j[0],className:"w-[100px] h-[100px] rounded-full border-4 border-white/5"}),(0,b.jsx)("span",{className:"text-[11px] font-black text-white/40 uppercase tracking-widest",children:"Group Avatar"})]}),(0,b.jsxs)("div",{className:"w-full space-y-6 pb-12",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-[11px] font-black text-white/40 uppercase tracking-[0.2em] ml-2",children:"Group Name"}),(0,b.jsx)("div",{className:"p-4 bg-[#0A0A0A] border border-white/10 rounded-2xl",children:(0,b.jsx)("input",{value:j,onChange:a=>k(a.target.value),onBlur:F,className:"w-full bg-transparent border-none outline-none text-white font-bold"})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-[11px] font-black text-white/40 uppercase tracking-[0.2em] ml-2",children:"Description"}),(0,b.jsx)("div",{className:"p-4 bg-[#0A0A0A] border border-white/10 rounded-2xl min-h-[80px]",children:(0,b.jsx)("textarea",{value:l,onChange:a=>m(a.target.value),className:"w-full bg-transparent border-none outline-none text-white font-bold resize-none h-full"})})]}),(0,b.jsxs)("button",{onClick:()=>v(!0),className:"w-full flex items-center gap-4 p-4 bg-[#0A0A0A] border border-white/10 rounded-2xl hover:bg-white/5 transition-all group",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary group-hover:scale-110 transition-transform",children:(0,b.jsx)(A.Users,{className:"w-5 h-5"})}),(0,b.jsx)("span",{className:"text-white font-bold text-[15px]",children:"View Members"})]})]})]})]}),(0,b.jsx)("div",{className:"absolute inset-0 -z-10",onClick:c})]})}function C({roomId:a,user:g}){let[u,v]=(0,d.useState)([]),[w,x]=(0,d.useState)(""),[y,A]=(0,d.useState)(null),[C,D]=(0,d.useState)(!1),[E,F]=(0,d.useState)(!1),[G,H]=(0,d.useState)(!1),[I,J]=(0,d.useState)(!1),[K,L]=(0,d.useState)(null),[M,N]=(0,d.useState)(null),[O,P]=(0,d.useState)(!1),[Q,R]=(0,d.useState)(!0),[S,T]=(0,d.useState)("Chat Room"),[U,V]=(0,d.useState)(void 0),[W,X]=(0,d.useState)(void 0),Y=(0,d.useRef)(null),Z=(0,d.useRef)([]),$=(0,d.useRef)(null),_=(0,d.useRef)(null),aa=(0,e.createClient)(),ab=(0,c.useRouter)(),{startCall:ac}=(0,t.useCall)(),{addToast:ad}=(0,s.useToast)();(0,d.useEffect)(()=>{(async()=>{R(!0);let{data:b}=await aa.from("rooms").select("*, room_participants(user_id, profiles(username, full_name, avatar_url, gender))").eq("id",a).single();if(A(b),b)if(!1===b.is_group&&b.room_participants){let a=b.room_participants.find(a=>a.user_id!==g.id);if(a&&a.profiles){T((a.profiles.full_name||a.profiles.username||"Unknown User").toUpperCase()),V(a.profiles.avatar_url),X(a.profiles.gender);let{data:b}=await aa.from("blocked_users").select("*").eq("blocker_id",g.id).eq("blocked_id",a.user_id).maybeSingle();P(!!b)}}else T(`${(b.name||"Group Chat").toUpperCase()}...ðŸ’–`);let{data:c}=await aa.from("messages").select("*, profiles(username, avatar_url, gender), reply_item: messages!reply_to(content, message_type, profiles(username))").eq("room_id",a).order("created_at",{ascending:!0});c&&v(c),R(!1)})();let b=aa.channel(`room:${a}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`room_id=eq.${a}`},async a=>{let{data:b}=await aa.from("messages").select("*, profiles(username, avatar_url, gender), reply_item: messages!reply_to(content, message_type, profiles(username))").eq("id",a.new.id).single();b&&v(a=>[...a,b])}).subscribe();return()=>{aa.removeChannel(b)}},[a,g.id,aa]),(0,d.useEffect)(()=>{$.current&&($.current.scrollTop=$.current.scrollHeight);let a=u.filter(a=>a.user_id!==g.id&&!a.read_at).map(a=>a.id);a.length>0&&aa.from("messages").update({read_at:new Date().toISOString()}).in("id",a).then(()=>{})},[u,g.id,aa]);let ae=a=>{switch(a?.toLowerCase()){case"male":return"#00BFFF";case"female":return"#FFB6C1";case"other":return"#FFD700";default:return"#FFF"}},af=async(b,c="text",d,e)=>{if(b&&b.preventDefault(),O)return;let f="text"===c?w:null;if("text"===c&&!f?.trim())return;f||"text"===c||(f="image"===c?"ðŸ“· Image":"video"===c?"ðŸ“¹ Video":"audio"===c?"ðŸŽ¤ Voice Note":"ðŸ“Ž Attachment");let{error:h}=await aa.from("messages").insert({room_id:a,user_id:g.id,content:f,message_type:c,media_url:d,media_meta:e,reply_to:M?.id,status:"sent",is_deleted:!1});h||("text"===c&&x(""),N(null),await aa.from("rooms").update({updated_at:new Date().toISOString()}).eq("id",a))},ag=async a=>{let{error:b}=await aa.from("messages").update({content:"ðŸš« Message deleted",is_deleted:!0,media_url:null,media_meta:null}).eq("id",a);b&&ad("Failed to delete message","error")},ah=async()=>{if(!O)try{let a=await navigator.mediaDevices.getUserMedia({audio:!0}),b=new MediaRecorder(a);Y.current=b,Z.current=[],b.ondataavailable=a=>{a.data.size>0&&Z.current.push(a.data)},b.onstop=()=>{let b=new Blob(Z.current,{type:"audio/webm"});L(b),a.getTracks().forEach(a=>a.stop())},b.start(),J(!0)}catch(a){console.error("Error accessing microphone:",a),ad("Could not access microphone","error")}},ai=async()=>{if(!y||y.is_group)return;let a=y.room_participants?.find(a=>a.user_id!==g?.id);if(a)try{O?(await aa.from("blocked_users").delete().eq("blocker_id",g?.id).eq("blocked_id",a.user_id),P(!1),ad("User unblocked","success")):(await aa.from("blocked_users").insert({blocker_id:g?.id,blocked_id:a.user_id}),P(!0),ad("User blocked","error"),ab.push("/chat"))}catch(a){ad("Action failed","error")}};return Q?(0,b.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center bg-black",children:[(0,b.jsx)(p.Loader2,{className:"w-10 h-10 text-primary animate-spin"}),(0,b.jsx)("p",{className:"mt-4 text-white/50 font-bold tracking-widest uppercase text-[10px]",children:"Establishing Secure Line..."})]}):(0,b.jsxs)("div",{className:"flex flex-col h-full bg-black relative",children:[(0,b.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-primary/5 rounded-full blur-[120px] pointer-events-none"}),(0,b.jsxs)("div",{className:"px-6 py-4 flex items-center justify-between bg-black/80 backdrop-blur-xl border-b border-white/5 z-20",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{onClick:()=>ab.push("/chat"),className:"p-2 -ml-2 hover:bg-white/5 rounded-xl text-white/30 hover:text-white transition-all",children:(0,b.jsx)(h,{className:"w-6 h-6",strokeWidth:3})}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"w-11 h-11 rounded-2xl p-0.5 bg-gradient-to-br from-primary/30 to-secondary/30",children:(0,b.jsx)(f.Avatar,{src:U,fallback:S[0]||"?",className:"w-full h-full rounded-[14px]"})}),(0,b.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-3.5 h-3.5 bg-online border-[3px] border-black rounded-full shadow-lg shadow-online/20"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-[17px] font-black tracking-tight",style:{color:ae(W)},children:S}),y?.is_group?(0,b.jsxs)("p",{className:"text-[11px] font-black text-online uppercase tracking-widest mt-0.5",children:[y.room_participants?.length||0," online â€¢ ",y.room_participants?.length||0," members"]}):(0,b.jsx)("p",{className:"text-[11px] font-black text-online uppercase tracking-widest mt-0.5",children:"Online"})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-1",children:(0,b.jsx)("button",{onClick:()=>{y?.is_group?H(!0):F(!0)},className:"p-2.5 hover:bg-white/5 rounded-xl text-white/40 hover:text-white transition-all",children:(0,b.jsx)(o,{className:"w-6 h-6",strokeWidth:2.5})})})]}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 custom-scrollbar relative z-10",ref:$,children:[(0,b.jsx)("div",{className:"flex justify-center mb-8",children:(0,b.jsx)("div",{className:"px-4 py-1 rounded-full bg-white/5 border border-white/10",children:(0,b.jsx)("span",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.2em]",children:"Today"})})}),u.map((a,c)=>{let d=a.user_id===g.id,e=u[c-1],h=e?.user_id===a.user_id;return(0,b.jsxs)("div",{className:(0,r.cn)("flex flex-col",d?"items-end":"items-start"),children:[!d&&!h&&(0,b.jsx)("span",{className:"text-[10px] font-black text-white/20 mb-1.5 ml-14 uppercase tracking-wider",style:{color:ae(a.profiles?.gender)},children:a.profiles?.username}),(0,b.jsxs)("div",{className:(0,r.cn)("flex items-end gap-3 max-w-[85%]",d&&"flex-row-reverse"),children:[!d&&(0,b.jsx)("div",{className:"w-8 h-8 rounded-xl overflow-hidden ring-1 ring-white/10 flex-shrink-0",children:h?(0,b.jsx)("div",{className:"w-full h-full"}):(0,b.jsx)(f.Avatar,{src:a.profiles?.avatar_url||"",fallback:a.profiles?.username?.[0]||"?",className:"w-full h-full"})}),(0,b.jsxs)("div",{className:(0,r.cn)("px-4 py-2.5 relative group transition-all",d?"bg-primary text-black rounded-[18px] rounded-br-[4px]":"bg-[#1A1A1A] text-white rounded-[18px] rounded-bl-[4px]"),children:[(0,b.jsxs)("div",{className:(0,r.cn)("absolute -top-8 px-2 py-1 bg-black/60 backdrop-blur-md rounded-xl border border-white/10 flex gap-2 opacity-0 group-hover:opacity-100 transition-all z-20",d?"right-0":"left-0"),children:[(0,b.jsx)("button",{onClick:()=>N(a),className:"text-white/60 hover:text-primary transition-colors",children:(0,b.jsx)(q,{size:14})}),d&&!a.is_deleted&&(0,b.jsx)("button",{onClick:()=>ag(a.id),className:"text-white/60 hover:text-secondary transition-colors",children:(0,b.jsx)(n,{size:14})})]}),a.is_deleted?(0,b.jsx)("p",{className:"italic text-[13px] opacity-40 font-medium tracking-tight",children:"ðŸš« Ghost message deleted"}):(0,b.jsxs)(b.Fragment,{children:[a.reply_item&&(0,b.jsxs)("div",{className:(0,r.cn)("mb-2 p-2 rounded-xl flex flex-col gap-0.5 border-l-4",d?"bg-black/5 border-black/20":"bg-white/5 border-primary/40"),children:[(0,b.jsx)("span",{className:(0,r.cn)("text-[9px] font-black uppercase tracking-widest",d?"text-black/50":"text-primary/70"),children:a.reply_item.profiles?.username||"GOSSIPER"}),(0,b.jsx)("p",{className:(0,r.cn)("text-[11px] font-bold truncate italic opacity-60",d?"text-black":"text-white"),children:"text"===a.reply_item.message_type?a.reply_item.content:`[MEDIA ${a.reply_item.message_type.toUpperCase()}]`})]}),"text"===a.message_type&&(0,b.jsx)("p",{className:"text-[15px] font-medium leading-relaxed tracking-tight",children:a.content}),"image"===a.message_type&&(0,b.jsx)("div",{className:"rounded-2xl overflow-hidden my-1 border border-white/10",children:(0,b.jsx)("img",{src:a.media_url||"",alt:"",className:"max-w-full max-h-[400px] w-auto h-auto object-cover"})})]}),(0,b.jsxs)("div",{className:(0,r.cn)("flex items-center gap-1.5 mt-1.5",d?"justify-end":"justify-start"),children:[(0,b.jsx)("span",{className:(0,r.cn)("text-[10px] font-black uppercase tracking-widest",d?"text-black/40":"text-white/20"),children:new Date(a.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),d&&(a.read_at?(0,b.jsx)(m,{size:12,className:"text-black/60"}):(0,b.jsx)(l.Check,{size:12,className:"text-black/40"}))]})]})]})]},a.id)}),C&&(0,b.jsx)("div",{className:"flex justify-end pr-4",children:(0,b.jsxs)("div",{className:"bg-primary/20 p-2 rounded-xl flex items-center gap-2 border border-primary/20",children:[(0,b.jsx)(p.Loader2,{className:"w-4 h-4 animate-spin text-primary"}),(0,b.jsx)("span",{className:"text-[11px] font-black text-primary uppercase tracking-widest",children:"Transmitting..."})]})})]}),(0,b.jsx)("form",{onSubmit:a=>af(a,"text"),className:"p-4 bg-black",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex-1 flex items-center bg-[#1A1A1A] rounded-[28px] px-4 py-1 border border-white/5",children:[(0,b.jsx)("button",{type:"button",className:"p-2 text-white/40 hover:text-white",children:(0,b.jsxs)("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,b.jsx)("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),(0,b.jsx)("line",{x1:"9",y1:"9",x2:"9.01",y2:"9"}),(0,b.jsx)("line",{x1:"15",y1:"9",x2:"15.01",y2:"9"})]})}),(0,b.jsx)("input",{value:w,onChange:a=>x(a.target.value),placeholder:"Message...",className:"flex-1 bg-transparent border-none outline-none px-2 text-[15px] text-white placeholder:text-white/20 h-11"}),(0,b.jsx)("button",{type:"button",onClick:()=>_.current?.click(),className:"p-2 text-white/40 hover:text-white",children:(0,b.jsx)(k,{className:"w-5 h-5"})})]}),(0,b.jsx)("button",{type:w.trim()?"submit":"button",onClick:w.trim()?void 0:I?()=>{Y.current&&I&&(Y.current.stop(),J(!1))}:ah,className:(0,r.cn)("w-12 h-12 rounded-full flex items-center justify-center transition-all",w.trim()?"bg-primary text-black":"bg-[#1A1A1A] text-white/60"),children:w.trim()?(0,b.jsx)(j,{className:"w-5 h-5 ml-0.5"}):(0,b.jsx)(i.Mic,{className:(0,r.cn)("w-5 h-5",I&&"text-red-500 animate-pulse")})})]})}),G&&(0,b.jsx)(B,{roomId:a,onClose:()=>H(!1),currentUserId:g.id}),E&&(0,b.jsx)(z,{onClose:()=>F(!1),onVoiceCall:()=>{F(!1),ac(a,!1)},onVideoCall:()=>{F(!1),ac(a,!0)},onBlockUser:()=>{F(!1),ai()},isBlocked:O,isGroup:!1})]})}var D=a.i(25717),E=a.i(52437),F=a.i(93033),G=a.i(93205),H=a.i(31349);let I=(0,g.default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function J({onClose:a,currentUserId:c}){let[g,h]=(0,d.useState)(""),[i,j]=(0,d.useState)([]),[k,m]=(0,d.useState)(!1),[n,o]=(0,d.useState)(new Set),p=(0,e.createClient)(),{addToast:q}=(0,s.useToast)(),t=async()=>{if(!g.trim())return;m(!0);let{data:a,error:b}=await p.from("profiles").select("*").or(`username.ilike.%${g}%,full_name.ilike.%${g}%`).neq("id",c).limit(10);a&&j(a),m(!1)},v=async a=>{o(b=>new Set(b).add(a));let{data:b,error:d}=await p.from("connections").select("*").or(`and(requester_id.eq.${c},addressee_id.eq.${a}),and(requester_id.eq.${a},addressee_id.eq.${c})`).maybeSingle();if(d)return void console.error("Error checking connection:",d);let e=null;if(b)if("rejected"===b.status){let{error:d}=await p.from("connections").update({status:"pending",requester_id:c,addressee_id:a}).eq("id",b.id);e=d}else console.log("Connection already exists or is pending.");else{let{error:b}=await p.from("connections").insert({requester_id:c,addressee_id:a});e=b}e?(console.error("Failed to send request",e),o(b=>{let c=new Set(b);return c.delete(a),c}),q("Failed to send request: "+e.message,"error")):q("Request sent!","success")};return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:(0,b.jsxs)("div",{className:"w-full max-w-md bg-[#1e1e24] border border-white/10 rounded-2xl shadow-2xl overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-white/5 flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-white",children:"Find People"}),(0,b.jsx)("button",{onClick:a,className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:(0,b.jsx)(u.X,{className:"w-5 h-5 text-white/70"})})]}),(0,b.jsxs)("div",{className:"p-4 space-y-4",children:[(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(H.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-white/50"}),(0,b.jsx)("input",{type:"text",placeholder:"Search by username...",className:"w-full bg-white/5 border border-white/10 rounded-xl py-2 pl-9 pr-4 text-white placeholder:text-white/30 focus:outline-none focus:ring-2 focus:ring-primary/50 transition-all",value:g,onChange:a=>h(a.target.value),onKeyDown:a=>"Enter"===a.key&&t()})]}),(0,b.jsx)("button",{onClick:t,disabled:k,className:"px-4 py-2 bg-primary text-primary-foreground font-medium rounded-xl hover:bg-primary/90 transition-colors disabled:opacity-50",children:k?"...":"Search"})]}),(0,b.jsxs)("div",{className:"space-y-2 max-h-[300px] overflow-y-auto custom-scrollbar",children:[0===i.length&&!k&&g&&(0,b.jsx)("p",{className:"text-center text-white/30 py-4",children:"No users found."}),i.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 border border-transparent hover:border-white/5 transition-all",children:[(0,b.jsx)(f.Avatar,{src:a.avatar_url||void 0,fallback:a.username||a.full_name||"?"}),(0,b.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,b.jsx)("p",{className:"font-semibold text-white truncate",children:a.full_name||a.username||"Unknown"}),(0,b.jsxs)("p",{className:"text-xs text-white/50 truncate",children:["@",a.username]})]}),(0,b.jsx)("button",{onClick:()=>v(a.id),disabled:n.has(a.id),className:(0,r.cn)("p-2 rounded-full transition-all",n.has(a.id)?"bg-green-500/20 text-green-400":"bg-primary/10 text-primary hover:bg-primary/20"),children:n.has(a.id)?(0,b.jsx)(l.Check,{className:"w-4 h-4"}):(0,b.jsx)(I,{className:"w-4 h-4"})})]},a.id))]})]})]})})}let K=(0,g.default)("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);function L({onClose:a,currentUserId:g}){let[h,i]=(0,d.useState)([]),[j,k]=(0,d.useState)(!0),m=(0,e.createClient)(),n=(0,c.useRouter)();(0,d.useEffect)(()=>{o()},[]);let o=async()=>{let{data:a,error:b}=await m.from("connections").select("*, requester:profiles!requester_id(*)").eq("addressee_id",g).eq("status","pending");a&&i(a),k(!1)},p=async(a,b)=>{let{error:c}=await m.from("connections").update({status:b}).eq("id",a);if(!c&&(i(b=>b.filter(b=>b.id!==a)),"accepted"===b)){let b=h.find(b=>b.id===a);b&&await q(b.requester_id)}},q=async b=>{k(!0);let{data:c,error:d}=await m.from("rooms").insert({is_group:!1,name:"Direct Message"}).select().single();c?(await m.from("room_participants").insert([{room_id:c.id,user_id:g},{room_id:c.id,user_id:b}]),a(),n.push(`/chat?roomId=${c.id}`)):(console.error("Failed to create room",d),k(!1))};return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:(0,b.jsxs)("div",{className:"w-full max-w-md bg-[#1e1e24] border border-white/10 rounded-2xl shadow-2xl overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-white/5 flex items-center justify-between",children:[(0,b.jsxs)("h2",{className:"text-lg font-bold text-white flex items-center gap-2",children:[(0,b.jsx)(K,{className:"w-5 h-5 text-primary"}),"Connection Requests"]}),(0,b.jsx)("button",{onClick:a,className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:(0,b.jsx)(u.X,{className:"w-5 h-5 text-white/70"})})]}),(0,b.jsxs)("div",{className:"p-4 space-y-2 max-h-[400px] overflow-y-auto custom-scrollbar",children:[j&&(0,b.jsx)("p",{className:"text-center text-white/30 py-4",children:"Loading..."}),!j&&0===h.length&&(0,b.jsxs)("div",{className:"text-center text-white/30 py-8 flex flex-col items-center gap-2",children:[(0,b.jsx)(K,{className:"w-10 h-10 opacity-20"}),(0,b.jsx)("p",{children:"No pending requests."})]}),h.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-white/5 border border-white/5",children:[(0,b.jsx)(f.Avatar,{src:a.requester?.avatar_url||void 0,fallback:a.requester?.username||"?"}),(0,b.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,b.jsx)("p",{className:"font-semibold text-white truncate",children:a.requester?.full_name||a.requester?.username||"Unknown User"}),(0,b.jsx)("p",{className:"text-xs text-white/50 truncate",children:"wants to connect"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("button",{onClick:()=>p(a.id,"accepted"),className:"p-2 bg-green-500/20 text-green-400 hover:bg-green-500/30 rounded-full transition-colors",title:"Accept",children:(0,b.jsx)(l.Check,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>p(a.id,"rejected"),className:"p-2 bg-red-500/20 text-red-400 hover:bg-red-500/30 rounded-full transition-colors",title:"Reject",children:(0,b.jsx)(u.X,{className:"w-4 h-4"})})]})]},a.id))]})]})})}var M=a.i(34662),N=a.i(29600);let O=(0,g.default)("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),P=(0,g.default)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);var Q=a.i(88409);let R=(0,g.default)("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),S=(0,g.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),T=(0,g.default)("languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);var U=a.i(53004),V=a.i(6846),W=a.i(22536),X=a.i(93311),Y=a.i(34240);let Z={English:{profile:"Profile",personalInfo:"PERSONAL INFO",settings:"SETTINGS",notifications:"Notifications",language:"Language",logout:"Logout",fullName:"Full Name",username:"Username",age:"Age",phone:"Phone",bio:"Bio",edit:"Edit",save:"Save Changes",cancel:"Cancel",gender:"Gender",male:"Male",female:"Female",other:"Other"},Tamil:{profile:"à®šà¯à®¯à®µà®¿à®µà®°à®®à¯",personalInfo:"à®¤à®©à®¿à®ªà¯à®ªà®Ÿà¯à®Ÿ à®¤à®•à®µà®²à¯",settings:"à®…à®®à¯ˆà®ªà¯à®ªà¯à®•à®³à¯",notifications:"à®…à®±à®¿à®µà®¿à®ªà¯à®ªà¯à®•à®³à¯",language:"à®®à¯Šà®´à®¿",logout:"à®µà¯†à®³à®¿à®¯à¯‡à®±à¯",fullName:"à®®à¯à®´à¯ à®ªà¯†à®¯à®°à¯",username:"à®ªà®¯à®©à®°à¯à®ªà¯†à®¯à®°à¯",age:"à®µà®¯à®¤à¯",phone:"à®¤à¯Šà®²à¯ˆà®ªà¯‡à®šà®¿",bio:"à®šà¯à®¯à®šà®°à®¿à®¤à¯ˆ",edit:"à®¤à¯Šà®•à¯",save:"à®®à®¾à®±à¯à®±à®™à¯à®•à®³à¯ˆ à®šà¯‡à®®à®¿",cancel:"à®°à®¤à¯à®¤à¯à®šà¯†à®¯à¯",gender:"à®ªà®¾à®²à®¿à®©à®®à¯",male:"à®†à®£à¯",female:"à®ªà¯†à®£à¯",other:"à®®à®±à¯à®±à®µà¯ˆ"}};function $({onClose:a,user:c}){let[g,h]=(0,d.useState)(!1),[i,j]=(0,d.useState)("English"),[k,l]=(0,d.useState)(null),[m,n]=(0,d.useState)([]),[o,q]=(0,d.useState)(!0),[r,t]=(0,d.useState)(!1),[v,w]=(0,d.useState)(!0),[x,y]=(0,d.useState)("info"),z=(0,d.useRef)(null),A=(0,e.createClient)(),{addToast:B}=(0,s.useToast)(),{logout:C}=(0,W.useAuth)(),D=Z[i],[F,G]=(0,d.useState)({full_name:"",username:"",age:"",phone:"",bio:"",gender:""});(0,d.useEffect)(()=>{(async()=>{q(!0);let{data:a}=await X.ProfileService.getProfile(c.id);a&&(l(a),G({full_name:a.full_name||"",username:a.username||"",age:a.age?.toString()||"",phone:a.phone||"",bio:a.bio||"",gender:a.gender||""}));let{data:b}=await A.from("blocked_users").select("*, blocked:profiles!blocked_id(*)").eq("blocker_id",c.id);b&&n(b),q(!1)})()},[c.id,A]);let H=async()=>{t(!0);let{error:a}=await X.ProfileService.updateProfile(c.id,{...F,age:parseInt(F.age)||void 0});a?B(a,"error"):(B("Profile updated","success"),h(!1),l(a=>a?{...a,...F,age:parseInt(F.age)||void 0}:null)),t(!1)},I=async a=>{let b=a.target.files?.[0];if(!b)return;t(!0);let{data:d,error:e}=await X.ProfileService.uploadAvatar(c.id,b);d?(await X.ProfileService.updateProfile(c.id,{avatar_url:d}),l(a=>a?{...a,avatar_url:d}:null),B("Avatar updated","success")):e&&B(e,"error"),t(!1)},J=async a=>{let{error:b}=await A.from("blocked_users").delete().eq("id",a);b||(n(b=>b.filter(b=>b.id!==a)),B("User unblocked","success"))},K=()=>{switch(F.gender?.toLowerCase()){case"male":return"from-[#00BFFF] to-transparent";case"female":return"from-[#FFB6C1] to-transparent";case"other":return"from-[#FFD700] to-transparent";default:return"from-primary/20 to-transparent"}};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/95 backdrop-blur-xl flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-black border border-white/10 w-full max-w-2xl rounded-[40px] shadow-2xl overflow-hidden relative flex flex-col max-h-[90vh]",children:[(0,b.jsx)("div",{className:`absolute top-0 left-0 right-0 h-64 bg-gradient-to-b ${K()} opacity-20 pointer-events-none transition-all duration-500`}),(0,b.jsxs)("div",{className:"p-8 pb-4 flex items-center justify-between relative z-10",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-3 rounded-2xl bg-white/5 border border-white/10",children:(0,b.jsx)(M.Shield,{className:"w-6 h-6 text-primary"})}),(0,b.jsxs)("h2",{className:"text-2xl font-black text-white italic uppercase tracking-tight",children:["Identity ",(0,b.jsx)("span",{className:"text-primary",children:"&"})," Settings"]})]}),(0,b.jsx)("button",{onClick:a,className:"p-3 bg-white/5 hover:bg-white/10 rounded-2xl text-white/40 hover:text-white transition-all shadow-lg",children:(0,b.jsx)(u.X,{className:"w-6 h-6"})})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-8 pt-0 relative z-10",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-8",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:w-48",children:[(0,b.jsxs)("button",{onClick:()=>y("info"),className:`flex items-center gap-3 p-4 rounded-2xl transition-all border ${"info"===x?"bg-primary/10 border-primary/20 text-primary shadow-lg shadow-primary/5":"bg-white/5 border-white/5 text-white/40 hover:text-white hover:bg-white/10"}`,children:[(0,b.jsx)(R,{className:"w-5 h-5"}),(0,b.jsx)("span",{className:"font-black text-[10px] uppercase tracking-[0.2em]",children:"Profile"})]}),(0,b.jsxs)("button",{onClick:()=>y("settings"),className:`flex items-center gap-3 p-4 rounded-2xl transition-all border ${"settings"===x?"bg-primary/10 border-primary/20 text-primary shadow-lg shadow-primary/5":"bg-white/5 border-white/5 text-white/40 hover:text-white hover:bg-white/10"}`,children:[(0,b.jsx)(T,{className:"w-5 h-5"}),(0,b.jsx)("span",{className:"font-black text-[10px] uppercase tracking-[0.2em]",children:"Options"})]}),(0,b.jsxs)("button",{onClick:()=>y("blocked"),className:`flex items-center gap-3 p-4 rounded-2xl transition-all border ${"blocked"===x?"bg-secondary/10 border-secondary/20 text-secondary shadow-lg shadow-secondary/5":"bg-white/5 border-white/5 text-white/40 hover:text-white hover:bg-white/10"}`,children:[(0,b.jsx)(O,{className:"w-5 h-5"}),(0,b.jsx)("span",{className:"font-black text-[10px] uppercase tracking-[0.2em]",children:"Ghosts"})]}),(0,b.jsxs)("div",{className:"mt-auto pt-8",children:[(0,b.jsxs)("button",{onClick:C,className:"w-full flex items-center justify-center gap-2 p-4 rounded-2xl bg-secondary opacity-80 hover:opacity-100 transition-all text-black font-black uppercase text-[10px] tracking-widest shadow-lg shadow-secondary/10",children:[(0,b.jsx)(E.LogOut,{className:"w-4 h-4"}),D.logout]}),(0,b.jsx)("p",{className:"text-center text-[9px] font-black text-white/20 mt-4 tracking-[0.3em] uppercase",children:"GOSSIP v1.2.0 â€¢ Web"})]})]}),(0,b.jsxs)("div",{className:"flex-1",children:["info"===x&&(0,b.jsxs)("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center gap-6",children:[(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsxs)("div",{className:"w-32 h-32 rounded-[40px] p-1 bg-gradient-to-br from-primary via-white/10 to-secondary shadow-2xl relative overflow-hidden",children:[(0,b.jsx)("div",{className:`absolute inset-0 bg-gradient-to-br ${K()} opacity-40 blur-xl group-hover:opacity-60 transition-opacity`}),(0,b.jsx)(f.Avatar,{src:k?.avatar_url||c.user_metadata?.avatar_url,fallback:k?.username?.[0]||"?",className:"w-full h-full rounded-[36px] relative z-10"})]}),(0,b.jsx)("button",{onClick:()=>{z.current?.click()},className:"absolute -bottom-2 -right-2 p-3 bg-primary text-black rounded-2xl shadow-xl hover:scale-110 transition-transform z-20 border-4 border-black",disabled:r,children:(0,b.jsx)(Q.Camera,{className:"w-4 h-4"})}),(0,b.jsx)("input",{type:"file",ref:z,className:"hidden",onChange:I,accept:"image/*"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(Y.GradientText,{text:k?.full_name||"NEW GOSSIPER",className:"text-3xl font-black italic uppercase tracking-tighter"}),(0,b.jsxs)("p",{className:"text-white/30 text-[10px] font-black tracking-[0.3em] uppercase mt-1",children:["@",k?.username||"unknown"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-[10px] font-black text-white/30 uppercase tracking-widest ml-4",children:D.fullName}),(0,b.jsx)("input",{value:F.full_name,onChange:a=>G(b=>({...b,full_name:a.target.value})),className:"w-full bg-white/5 border border-white/10 rounded-2xl p-4 text-white font-bold focus:border-primary/50 transition-all outline-none",placeholder:"Enter full name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-[10px] font-black text-white/30 uppercase tracking-widest ml-4",children:D.username}),(0,b.jsx)("input",{value:F.username,onChange:a=>G(b=>({...b,username:a.target.value})),className:"w-full bg-white/5 border border-white/10 rounded-2xl p-4 text-white font-bold focus:border-primary/50 transition-all outline-none",placeholder:"username"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-[10px] font-black text-white/30 uppercase tracking-widest ml-4",children:D.gender}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-2",children:["Male","Female","Other"].map(a=>(0,b.jsx)("button",{onClick:()=>G(b=>({...b,gender:a})),className:`p-4 rounded-xl font-black text-[10px] uppercase tracking-widest transition-all border ${F.gender===a?"bg-primary text-black border-primary":"bg-white/5 text-white/30 border-white/5 hover:border-white/10"}`,children:D[a.toLowerCase()]},a))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-[10px] font-black text-white/30 uppercase tracking-widest ml-4",children:D.age}),(0,b.jsx)("input",{value:F.age,onChange:a=>G(b=>({...b,age:a.target.value})),className:"w-full bg-white/5 border border-white/10 rounded-2xl p-4 text-white font-bold focus:border-primary/50 transition-all outline-none",placeholder:"25",type:"number"})]}),(0,b.jsxs)("div",{className:"md:col-span-2 space-y-2",children:[(0,b.jsx)("label",{className:"text-[10px] font-black text-white/30 uppercase tracking-widest ml-4",children:D.bio}),(0,b.jsx)("textarea",{value:F.bio,onChange:a=>G(b=>({...b,bio:a.target.value})),className:"w-full bg-white/5 border border-white/10 rounded-2xl p-4 text-white font-bold focus:border-primary/50 transition-all outline-none h-24 resize-none",placeholder:"Tell Your Story..."})]})]}),(0,b.jsxs)("button",{onClick:H,disabled:r,className:"w-full py-5 bg-gradient-to-r from-primary to-primary-dark text-black font-black uppercase italic tracking-[0.2em] rounded-2xl shadow-xl shadow-primary/10 hover:scale-[1.02] transition-all flex items-center justify-center gap-3 active:scale-95",children:[r?(0,b.jsx)(p.Loader2,{className:"w-5 h-5 animate-spin"}):(0,b.jsx)(S,{className:"w-5 h-5"}),D.save]})]}),"settings"===x&&(0,b.jsxs)("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-500",children:[(0,b.jsxs)("div",{className:"p-6 rounded-3xl bg-white/5 border border-white/10 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 bg-primary/10 rounded-2xl",children:(0,b.jsx)(U.Bell,{className:"w-5 h-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-black uppercase text-white tracking-widest",children:D.notifications}),(0,b.jsx)("p",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest",children:"Real-time alerts"})]})]}),(0,b.jsx)("button",{onClick:()=>w(!v),className:`w-14 h-8 rounded-full relative transition-all duration-300 ${v?"bg-primary":"bg-white/10"}`,children:(0,b.jsx)("div",{className:`absolute top-1 w-6 h-6 bg-white rounded-full transition-all duration-300 ${v?"left-7 shadow-lg shadow-black/20":"left-1"}`})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 bg-secondary/10 rounded-2xl",children:(0,b.jsx)(T,{className:"w-5 h-5 text-secondary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-black uppercase text-white tracking-widest",children:D.language}),(0,b.jsx)("p",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest",children:"Tamil & English supported"})]})]}),(0,b.jsxs)("select",{value:i,onChange:a=>j(a.target.value),className:"bg-white/10 border-none rounded-xl p-3 text-[10px] font-black text-white uppercase tracking-widest outline-none cursor-pointer",children:[(0,b.jsx)("option",{value:"English",className:"bg-black",children:"English"}),(0,b.jsx)("option",{value:"Tamil",className:"bg-black",children:"Tamil"})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 bg-white/5 rounded-2xl",children:(0,b.jsx)(N.Eye,{className:"w-5 h-5 text-white/40"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-black uppercase text-white tracking-widest",children:"Last Seen"}),(0,b.jsx)("p",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest",children:"Privacy control"})]})]}),(0,b.jsx)("button",{className:"w-14 h-8 rounded-full bg-primary relative",children:(0,b.jsx)("div",{className:"absolute top-1 left-7 w-6 h-6 bg-white rounded-full shadow-lg"})})]})]}),(0,b.jsxs)("div",{className:"p-6 rounded-3xl bg-secondary/10 border border-secondary/20 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(M.Shield,{className:"w-6 h-6 text-secondary"}),(0,b.jsxs)("p",{className:"text-[11px] font-black text-secondary uppercase tracking-widest leading-loose",children:["End-to-End Encryption",(0,b.jsx)("br",{}),(0,b.jsx)("span",{className:"text-white/40",children:"Verified & Active"})]})]}),(0,b.jsx)(V.ChevronRight,{className:"w-5 h-5 text-secondary opacity-40"})]})]}),"blocked"===x&&(0,b.jsx)("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-4 duration-500",children:(0,b.jsxs)("div",{className:"p-6 rounded-3xl bg-white/5 border border-white/10",children:[(0,b.jsx)("h3",{className:"text-[11px] font-black text-white/40 uppercase tracking-[0.2em] mb-6",children:"Blocked Manifest"}),o?(0,b.jsx)("div",{className:"flex flex-col items-center justify-center p-12",children:(0,b.jsx)(p.Loader2,{className:"w-8 h-8 animate-spin text-primary"})}):0===m.length?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center p-12 space-y-4",children:[(0,b.jsx)("div",{className:"p-6 bg-white/5 rounded-full border border-white/10",children:(0,b.jsx)(O,{className:"w-10 h-10 text-white/20"})}),(0,b.jsx)("p",{className:"text-xs font-bold text-white/20 uppercase tracking-widest italic text-center",children:"Your ghost list is empty"})]}):(0,b.jsx)("div",{className:"space-y-3",children:m.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between bg-black/40 p-3 rounded-2xl border border-white/5 group hover:border-white/20 transition-all",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(f.Avatar,{src:a.blocked?.avatar_url,fallback:a.blocked?.username?.[0]||"?",className:"w-10 h-10 rounded-xl"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[13px] font-black text-white uppercase tracking-tight",children:a.blocked?.username||"Unknown Entity"}),(0,b.jsx)("p",{className:"text-[9px] font-bold text-white/20 uppercase tracking-[0.2em]",children:"Restricted Access"})]})]}),(0,b.jsxs)("button",{onClick:()=>J(a.id),className:"flex items-center gap-2 px-4 py-2 bg-secondary/10 hover:bg-secondary text-secondary hover:text-black rounded-xl transition-all font-black text-[9px] uppercase tracking-widest",children:[(0,b.jsx)(P,{className:"w-3 h-3"}),"Restore"]})]},a.id))})]})})]})]})})]})})}let _=(0,g.default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var aa=a.i(78540);function ab({user:a}){let[g,h]=(0,d.useState)([]),[i,j]=(0,d.useState)([]),[k,l]=(0,d.useState)(!1),[m,n]=(0,d.useState)(!1),[o,p]=(0,d.useState)(!1),[q,s]=(0,d.useState)(0),[t,u]=(0,d.useState)(new Set),{statuses:v}=(0,aa.useStatus)(),w=(0,e.createClient)();(0,c.usePathname)();let x=(0,c.useSearchParams)(),y=(0,c.useRouter)(),z=x.get("roomId");(0,d.useEffect)(()=>{let b=async()=>{let{data:a}=await w.from("rooms").select(`
                    *,
                    room_participants(
                        user_id,
                        profiles(username, full_name, avatar_url, gender)
                    )
                `).order("updated_at",{ascending:!1});a&&h(a)},c=async()=>{let{count:b}=await w.from("connections").select("*",{count:"exact",head:!0}).eq("addressee_id",a?.id).eq("status","pending");s(b||0);let{data:c}=await w.from("connections").select(`
                    *,
                    requester:profiles!requester_id(username, avatar_url, full_name, gender),
                    addressee:profiles!addressee_id(username, avatar_url, full_name, gender)
                `).or(`requester_id.eq.${a.id},addressee_id.eq.${a.id}`).eq("status","accepted").limit(10);c&&j(c);let{data:d}=await w.from("blocked_users").select("blocked_id").eq("blocker_id",a.id);d&&u(new Set(d.map(a=>a.blocked_id)))};a&&(b(),c());let d=w.channel("rooms_realtime").on("postgres_changes",{event:"*",schema:"public",table:"rooms"},()=>b()).subscribe(),e=w.channel("connections_sidebar").on("postgres_changes",{event:"*",schema:"public",table:"connections"},()=>c()).subscribe();return()=>{w.removeChannel(d),w.removeChannel(e)}},[a,w]);let A=async()=>{await w.auth.signOut(),y.push("/login")};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("aside",{className:"w-full h-full bg-black text-foreground flex flex-col font-sans overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-[20px] pt-[10px] pb-[15px]",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(Y.GradientText,{text:"GOSSIP.",className:"text-[32px] font-[900] tracking-[0.5px]"}),(0,b.jsx)("img",{src:"/images/gossip_header_doodle.png",alt:"Gossip Doodle",className:"w-[50px] h-[50px] object-contain -mt-2 opacity-80"})]}),(0,b.jsxs)("button",{onClick:()=>n(!0),className:"relative p-1",children:[(0,b.jsxs)("div",{className:"w-[28px] h-[28px]",children:[(0,b.jsx)("img",{src:"data:image/svg+xml;base64,...",alt:"",className:"hidden"}),(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"}),(0,b.jsx)("path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0"})]})]}),q>0&&(0,b.jsx)("div",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] rounded-full bg-red-500 border-2 border-black flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-white text-[10px] font-[900]",children:q})})]})]}),(0,b.jsx)("p",{className:"text-[13px] text-[#888] font-medium mt-1",children:"Connect, share, and whisper in style."})]}),(0,b.jsx)("div",{className:"px-[20px] mb-[15px]",children:(0,b.jsxs)("div",{className:"bg-[#111] h-[48px] rounded-[24px] flex items-center px-[15px] gap-3 border border-[#222]",children:[(0,b.jsx)(H.Search,{className:"w-5 h-5 text-[#666]"}),(0,b.jsx)("input",{placeholder:"Search friends or gossip...",className:"bg-transparent border-none outline-none text-[15px] w-full placeholder-[#666] text-white font-normal",readOnly:!0,onClick:()=>l(!0)})]})}),(0,b.jsx)("div",{className:"px-4 mb-4",children:(0,b.jsxs)("div",{className:"bg-[#111] border border-[#222] rounded-[35px] p-5",children:[(0,b.jsx)("h3",{className:"text-[11px] font-[800] tracking-[1.5px] text-[#444] mb-4 uppercase ml-1",children:"VIBES"}),(0,b.jsxs)("div",{className:"flex gap-5 overflow-x-auto pb-2 scrollbar-hide",children:[(0,b.jsxs)("button",{onClick:()=>y.push("/chat/status"),className:"flex flex-col items-center gap-3 min-w-[58px]",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(f.Avatar,{src:a?.user_metadata?.avatar_url,fallback:a?.email?.[0]||"?",className:"w-[58px] h-[58px] rounded-full border-2 border-[#333] opacity-50"}),(0,b.jsx)("div",{className:"absolute bottom-0 right-0 w-[20px] h-[20px] bg-[#00BFFF] rounded-full flex items-center justify-center border-2 border-black",children:(0,b.jsx)(G.Plus,{className:"w-[12px] h-[12px] text-black",strokeWidth:3})})]}),(0,b.jsx)("span",{className:"text-[11px] font-bold text-white/60",children:"Your Vibe"})]}),Array.from(new Set(v.filter(b=>b.user_id!==a.id).map(a=>a.user_id))).map(a=>{let c=v.find(b=>b.user_id===a);if(!c||!c.profiles)return null;let d=c.profiles;return(0,b.jsxs)("button",{onClick:()=>y.push("/chat/status"),className:"flex flex-col items-center gap-3 min-w-[58px]",children:[(0,b.jsx)("div",{className:"relative p-[2px] rounded-full bg-gradient-to-tr from-[#00BFFF] to-[#FFB6C1]",children:(0,b.jsx)("div",{className:"p-[2px] bg-black rounded-full",children:(0,b.jsx)(f.Avatar,{src:d.avatar_url,fallback:d.username?.[0]||"?",className:"w-[50px] h-[50px]"})})}),(0,b.jsx)("span",{className:"text-[11px] font-black text-center truncate w-full text-white tracking-tight uppercase",children:d.username})]},a)})]})]})}),(0,b.jsx)("div",{className:"flex-1 px-4 mb-4 min-h-0 flex flex-col",children:(0,b.jsxs)("div",{className:"bg-[#111] border border-[#222] rounded-[35px] flex-1 flex flex-col overflow-hidden",children:[(0,b.jsx)("div",{className:"px-6 pt-5 pb-2 flex items-center gap-[10px]",children:(0,b.jsx)("h3",{className:"text-[11px] font-[800] tracking-[1.5px] text-[#444] uppercase",children:"RECENT GOSSIPS"})}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2",children:(0,b.jsxs)("div",{className:"space-y-1",children:[g.filter(b=>{let c=b.room_participants?.find(b=>b.user_id!==a?.id);return!(c&&t.has(c.user_id))}).map(c=>{let d,e,g=c.name||"UNNAMED CHAT",h=!1;if(c.room_participants){let b=c.room_participants.find(b=>b.user_id!==a?.id);b&&b.profiles&&(g=(b.profiles.full_name||b.profiles.username||"Unknown User").toUpperCase(),d=b.profiles.avatar_url,h=!0,e=b.profiles.gender)}let i=z===c.id;return(0,b.jsx)(D.default,{href:`/chat?roomId=${c.id}`,className:"block group",children:(0,b.jsxs)("div",{className:(0,r.cn)("px-6 py-3 transition-all cursor-pointer flex items-center gap-4",i?"bg-primary/10":"hover:bg-white/[0.03]"),children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(f.Avatar,{src:d,fallback:g[0]||"?",className:"w-[58px] h-[58px] rounded-full ring-2 ring-white/5"}),h&&(0,b.jsx)("span",{className:"absolute bottom-0 right-1 w-4 h-4 bg-online border-[3px] border-black rounded-full"})]}),(0,b.jsxs)("div",{className:"overflow-hidden flex-1 border-b border-white/5 pb-3 group-last:border-none",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,b.jsx)("p",{className:"text-[16px] font-black tracking-tight truncate",style:{color:(a=>{switch(a?.toLowerCase()){case"male":return"#00BFFF";case"female":return"#FFB6C1";case"other":return"#FFD700";default:return"#FFF"}})(e)},children:g}),(0,b.jsx)("p",{className:"text-[11px] font-bold text-white/20",children:(a=>{if(!a)return"";let b=new Date(a),c=Math.floor((new Date().getTime()-b.getTime())/6e4);if(c<1)return"Just now";if(c<60)return`${c}m`;let d=Math.floor(c/60);return d<24?`${d}h`:b.toLocaleDateString([],{month:"short",day:"numeric"})})(c.updated_at)})]}),(0,b.jsx)("div",{className:"flex justify-between items-center",children:(0,b.jsx)("p",{className:(0,r.cn)("text-xs truncate flex-1 pr-2 font-medium",i?"text-primary/70":"text-white/30"),children:c.last_message||"Started a gossip..."})})]})]})},c.id)}),0===g.length&&(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center p-12 text-center",children:[(0,b.jsx)(F.MessageSquare,{className:"w-12 h-12 text-white/10 mb-4"}),(0,b.jsx)("p",{className:"text-xs text-white/30 font-bold uppercase tracking-widest italic",children:"No gossips yet"})]})]})})]})}),(0,b.jsx)("div",{className:"p-4 border-t border-white/5 bg-black/80 backdrop-blur-md",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(f.Avatar,{src:a?.user_metadata?.avatar_url,fallback:a?.email||"?",className:"w-10 h-10 ring-2 ring-white/10 shadow-lg"}),(0,b.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,b.jsx)("p",{className:"text-[13px] font-black truncate text-white uppercase tracking-tight",children:a?.user_metadata?.username||a?.email?.split("@")[0]}),(0,b.jsx)("p",{className:"text-[11px] font-bold text-primary flex items-center gap-1 uppercase tracking-widest",children:"Online"})]}),(0,b.jsxs)("div",{className:"flex gap-1",children:[(0,b.jsx)("button",{onClick:()=>p(!0),className:"text-white/40 hover:text-white transition-colors p-2 hover:bg-white/5 rounded-xl",children:(0,b.jsx)(_,{className:"w-5 h-5"})}),(0,b.jsx)("button",{onClick:A,className:"text-white/40 hover:text-secondary transition-colors p-2 hover:bg-white/5 rounded-xl",children:(0,b.jsx)(E.LogOut,{className:"w-5 h-5"})})]})]})})]}),k&&(0,b.jsx)(J,{onClose:()=>l(!1),currentUserId:a?.id}),m&&(0,b.jsx)(L,{onClose:()=>n(!1),currentUserId:a?.id}),o&&(0,b.jsx)($,{onClose:()=>p(!1),user:a})]})}function ac(){let a=(0,c.useSearchParams)().get("roomId"),[f,g]=(0,d.useState)(null),h=(0,e.createClient)();return((0,d.useEffect)(()=>{h.auth.getUser().then(({data:{user:a}})=>g(a))},[h.auth]),f)?a?(0,b.jsx)(C,{roomId:a,user:f}):(0,b.jsx)(ab,{user:f}):null}function ad(){return(0,b.jsx)(d.Suspense,{fallback:(0,b.jsx)("div",{children:"Loading..."}),children:(0,b.jsx)(ac,{})})}a.s(["default",()=>ad],86544)}];

//# sourceMappingURL=Desktop_GOSSIP_src_app_chat_page_tsx_66e95179._.js.map
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,23130,4476,e=>{"use strict";let t=(0,e.i(7711).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],23130);var s=e.i(49982),a=e.i(77600),l=e.i(36835);function r(e){let t,r,i,c,o=(0,a.c)(10),{text:n,className:d,colors:u}=e;o[0]!==u?(t=void 0===u?["#00BFFF","#FFB6C1"]:u,o[0]=u,o[1]=t):t=o[1];let h=t;o[2]!==d?(r=(0,l.cn)("bg-clip-text text-transparent",d),o[2]=d,o[3]=r):r=o[3];let m=`linear-gradient(to right, ${h[0]}, ${h[1]})`;return o[4]!==m?(i={backgroundImage:m,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},o[4]=m,o[5]=i):i=o[5],o[6]!==r||o[7]!==i||o[8]!==n?(c=(0,s.jsx)("span",{className:r,style:i,children:n}),o[6]=r,o[7]=i,o[8]=n,o[9]=c):c=o[9],c}e.s(["GradientText",()=>r],4476)},48966,e=>{"use strict";let t=(0,e.i(7711).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],48966)},90047,e=>{"use strict";let t=(0,e.i(7711).default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);e.s(["Camera",()=>t],90047)},85647,e=>{"use strict";let t=(0,e.i(7711).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],85647)},63078,e=>{"use strict";var t=e.i(49982),s=e.i(32758),a=e.i(66635),l=e.i(48966),r=e.i(23130),i=e.i(90047),c=e.i(76845),o=e.i(85647),n=e.i(18409),d=e.i(4476),u=e.i(72013),h=e.i(78178),m=e.i(89934);function x(){let{statuses:e,loading:x,uploadStatus:p,refreshStatuses:b}=(0,s.useStatus)(),{user:f}=(0,a.useAuth)(),{addToast:g}=(0,m.useToast)(),[v,w]=(0,u.useState)(null),[j,N]=(0,u.useState)(0),[k,y]=(0,u.useState)(0),[C,F]=(0,u.useState)("grid"),[z,L]=(0,u.useState)(null),[R,S]=(0,u.useState)(""),[U,_]=(0,u.useState)(!1),M=(0,u.useRef)(null),T=(0,u.useRef)(null),P=(0,u.useRef)(null),B=(0,u.useRef)(null),O=Object.values(e.reduce((e,t)=>{let s=t.user_id;return e[s]||(e[s]={...t.profiles,items:[]}),e[s].items.push(t),e},{})).map(e=>({user:e,items:e.items}));(0,u.useEffect)(()=>()=>{z?.url&&URL.revokeObjectURL(z.url),W()},[]),(0,u.useEffect)(()=>{let e;return v&&(y(0),e=setInterval(()=>{y(e=>{if(e>=100)if(j<v.items.length-1)return N(j+1),0;else return w(null),0;return e+1})},50)),()=>clearInterval(e)},[v,j]);let A=async()=>{try{F("camera");let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!1});P.current=e,M.current&&(M.current.srcObject=e)}catch(e){console.error(e),g("Unable to access camera. Please check permissions.","error"),F("grid")}},W=()=>{P.current&&(P.current.getTracks().forEach(e=>e.stop()),P.current=null)},I=async e=>{let t=e.target.files?.[0];if(!t)return;if(t.size>0x3200000)return void g("File size too large. Max 50MB allowed.","error");let s=t.type.startsWith("video/");if(s&&await $(t)>32)return void g("Video too long. Max 30 seconds allowed.","error");let a=URL.createObjectURL(t);L({file:t,url:a,type:s?"video":"image"}),F("preview"),e.target.value=""},D=async()=>{if(z&&f){_(!0);try{let{data:e,error:t}=await h.StatusService.uploadMedia(z.file);if(t)throw Error(t);e&&(await p(e,R),g("Whisper posted!","success"),b(),E())}catch(e){g(e.message||"Failed to post whisper","error")}finally{_(!1)}}},E=()=>{F("grid"),L(null),S(""),P.current&&W()},$=e=>new Promise(t=>{try{let s=document.createElement("video");s.preload="metadata",s.onloadedmetadata=()=>{t(s.duration),window.URL.revokeObjectURL(s.src)},s.onerror=()=>t(0),s.src=URL.createObjectURL(e)}catch{t(0)}}),H=e=>{switch(e?.toLowerCase()){case"male":return"#00BFFF";case"female":return"#FFB6C1";case"other":return"#FFD700";default:return"#FFF"}},X=e=>["mp4","webm","mov","ogg"].includes(e.split(".").pop()?.toLowerCase()||"");return(0,t.jsxs)("div",{className:"flex-1 flex flex-col bg-black h-full relative overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-secondary/10 rounded-full blur-[150px] pointer-events-none"}),"grid"===C&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("header",{className:"p-8 pb-4 flex items-center justify-between relative z-10",children:[(0,t.jsx)("div",{className:"flex items-center gap-6",children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(d.GradientText,{text:"Whispers",className:"text-5xl font-black italic uppercase tracking-tighter"}),(0,t.jsx)("div",{className:"w-16 h-16 relative",children:(0,t.jsx)("img",{src:"/gossip_illustration.png",alt:"Whispers",className:"w-full h-full object-contain opacity-80"})})]}),(0,t.jsx)("p",{className:"text-white/30 text-xs font-bold uppercase tracking-[0.2em] mt-1",children:"Disappearing stories of your circle."})]})}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)("button",{onClick:A,className:"p-5 bg-white/5 border border-white/10 rounded-[24px] hover:bg-white/10 transition-all text-white",children:(0,t.jsx)(i.Camera,{className:"w-8 h-8"})}),(0,t.jsx)("input",{type:"file",ref:B,className:"hidden",accept:"image/*,video/*",onChange:I})]})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-8 pt-4 relative z-10",children:x?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)(r.Loader2,{className:"w-10 h-10 animate-spin text-secondary"})}):(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[(0,t.jsxs)("div",{onClick:()=>B.current?.click(),className:"aspect-[3/4] rounded-[40px] bg-white/5 border border-dashed border-white/20 flex flex-col items-center justify-center gap-4 hover:border-secondary transition-all cursor-pointer group active:scale-95",children:[(0,t.jsx)("div",{className:"w-20 h-20 rounded-[30px] bg-secondary/20 flex items-center justify-center text-secondary group-hover:scale-110 transition-all",children:(0,t.jsx)(l.Plus,{className:"w-10 h-10"})}),(0,t.jsx)("span",{className:"text-[10px] font-black uppercase tracking-widest text-white/30 group-hover:text-secondary transition-colors",children:"Post Whisper"})]}),O.map(e=>(0,t.jsxs)("div",{onClick:()=>{w(e),N(0),y(0)},className:"aspect-[3/4] rounded-[40px] relative overflow-hidden border border-white/10 hover:border-secondary transition-all cursor-pointer group",children:[X(e.items[0].media_url)?(0,t.jsx)("video",{src:e.items[0].media_url,className:"absolute inset-0 w-full h-full object-cover group-hover:scale-110 duration-700 transition-all",muted:!0,loop:!0}):(0,t.jsx)("img",{src:e.items[0].media_url,alt:"",className:"absolute inset-0 w-full h-full object-cover group-hover:scale-110 duration-700 transition-all"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/20 to-transparent"}),(0,t.jsx)("div",{className:"absolute top-6 left-6 right-6 flex gap-2",children:e.items.map((e,s)=>(0,t.jsx)("div",{className:"h-1 flex-1 bg-white/30 rounded-full overflow-hidden",children:0===s&&(0,t.jsx)("div",{className:"h-full bg-secondary w-full"})},s))}),(0,t.jsxs)("div",{className:"absolute bottom-6 left-6 flex items-center gap-3",children:[(0,t.jsx)("div",{className:"relative p-1 rounded-full border-2 border-secondary bg-black ring-4 ring-black",children:(0,t.jsx)(n.Avatar,{src:e.user.avatar_url,fallback:e.user.username?.[0]||"?",className:"w-10 h-10"})}),(0,t.jsxs)("div",{className:"overflow-hidden",children:[(0,t.jsx)("p",{className:"text-[14px] font-black uppercase text-white tracking-tight truncate italic",style:{color:H(e.user.gender)},children:e.user.username}),(0,t.jsx)("p",{className:"text-[9px] font-bold text-white/50 uppercase tracking-widest",children:new Date(e.items[0].created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})]},e.user.id))]})})]}),"camera"===C&&(0,t.jsx)("div",{className:"absolute inset-0 z-50 bg-black flex flex-col",children:(0,t.jsxs)("div",{className:"relative flex-1 bg-black overflow-hidden rounded-[40px] m-4 border border-white/10",children:[(0,t.jsx)("video",{ref:M,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),(0,t.jsx)("canvas",{ref:T,className:"hidden"}),(0,t.jsxs)("div",{className:"absolute bottom-10 left-0 right-0 flex items-center justify-center gap-12",children:[(0,t.jsx)("button",{onClick:E,className:"w-12 h-12 rounded-full bg-black/40 backdrop-blur-md border border-white/20 flex items-center justify-center",children:(0,t.jsx)(c.X,{className:"w-6 h-6 text-white"})}),(0,t.jsx)("button",{onClick:()=>{if(M.current&&T.current){let e=M.current,t=T.current;t.width=e.videoWidth,t.height=e.videoHeight;let s=t.getContext("2d");s&&(s.drawImage(e,0,0,t.width,t.height),t.toBlob(e=>{e&&(L({file:new File([e],`capture_${Date.now()}.png`,{type:"image/png"}),url:URL.createObjectURL(e),type:"image"}),F("preview"),W())},"image/png"))}},className:"w-20 h-20 rounded-full border-4 border-white flex items-center justify-center hover:scale-105 transition-transform active:scale-95 bg-white/10",children:(0,t.jsx)("div",{className:"w-16 h-16 bg-white rounded-full pointer-events-none"})}),(0,t.jsx)("div",{className:"w-12 h-12"})," "]})]})}),"preview"===C&&z&&(0,t.jsx)("div",{className:"absolute inset-0 z-50 bg-black flex flex-col animate-in zoom-in duration-300",children:(0,t.jsxs)("div",{className:"relative flex-1 m-4 rounded-[40px] overflow-hidden border border-white/10 bg-[#111]",children:["video"===z.type?(0,t.jsx)("video",{src:z.url,className:"w-full h-full object-contain",autoPlay:!0,loop:!0,playsInline:!0}):(0,t.jsx)("img",{src:z.url,className:"w-full h-full object-contain"}),(0,t.jsx)("button",{onClick:E,className:"absolute top-6 right-6 p-3 bg-black/20 hover:bg-black/40 rounded-full backdrop-blur-xl border border-white/10 text-white transition-all z-20",children:(0,t.jsx)(c.X,{className:"w-6 h-6"})}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black via-black/80 to-transparent pt-20",children:(0,t.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("input",{value:R,onChange:e=>S(e.target.value),placeholder:"Add a caption...",autoFocus:!0,className:"w-full bg-transparent text-white placeholder-white/50 text-lg font-medium outline-none border-b border-white/20 pb-2 focus:border-white transition-colors"})}),(0,t.jsx)("button",{onClick:D,disabled:U,className:"p-4 bg-secondary text-black rounded-full font-bold hover:scale-105 active:scale-95 transition-all disabled:opacity-50 disabled:scale-100 shadow-lg shadow-secondary/20",children:U?(0,t.jsx)(r.Loader2,{className:"w-6 h-6 animate-spin"}):(0,t.jsx)(o.Send,{className:"w-6 h-6"})})]})})]})}),v&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black z-[100] flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"relative w-full max-w-lg aspect-[9/16] rounded-[40px] overflow-hidden bg-white/5 shadow-2xl animate-in zoom-in duration-300",children:[X(v.items[j].media_url)?(0,t.jsx)("video",{src:v.items[j].media_url,className:"absolute inset-0 w-full h-full object-contain md:object-cover",autoPlay:!0,playsInline:!0,onEnded:()=>{j<v.items.length-1?(N(j+1),y(0)):w(null)}}):(0,t.jsx)("img",{src:v.items[j].media_url,alt:"",className:"absolute inset-0 w-full h-full object-contain md:object-cover"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-black/60 pointer-events-none"}),(0,t.jsx)("div",{className:"absolute top-8 left-8 right-8 flex gap-2 z-20",children:v.items.map((e,s)=>(0,t.jsxs)("div",{className:"h-1 flex-1 bg-white/20 rounded-full overflow-hidden",children:[s<j&&(0,t.jsx)("div",{className:"h-full bg-white w-full"}),s===j&&(0,t.jsx)("div",{className:"h-full bg-white transition-all duration-50",style:{width:`${k}%`}})]},s))}),(0,t.jsxs)("div",{className:"absolute top-14 left-8 right-8 flex items-center justify-between z-20",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(n.Avatar,{src:v.user.avatar_url,fallback:v.user.username[0],className:"w-12 h-12 ring-2 ring-white/50"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-white font-black italic uppercase tracking-tight",style:{color:H(v.user.gender)},children:v.user.username}),(0,t.jsx)("p",{className:"text-white/50 text-[10px] uppercase font-bold tracking-widest",children:new Date(v.items[j].created_at).toLocaleTimeString()})]})]}),(0,t.jsx)("button",{onClick:()=>w(null),className:"p-3 bg-black/20 hover:bg-black/40 rounded-full backdrop-blur-xl border border-white/10 text-white transition-all",children:(0,t.jsx)(c.X,{className:"w-6 h-6"})})]}),v.items[j].caption&&(0,t.jsx)("div",{className:"absolute bottom-16 left-8 right-8 z-20 text-center",children:(0,t.jsx)("p",{className:"text-white text-lg font-bold drop-shadow-lg",children:v.items[j].caption})}),(0,t.jsxs)("div",{className:"absolute inset-x-0 top-32 bottom-32 flex z-10",children:[(0,t.jsx)("div",{className:"flex-1 hover:bg-white/5 transition-all cursor-pointer",onClick:()=>{j>0&&(N(j-1),y(0))}}),(0,t.jsx)("div",{className:"flex-1 hover:bg-white/5 transition-all cursor-pointer",onClick:()=>{j<v.items.length-1?(N(j+1),y(0)):w(null)}})]})]})})]})}e.s(["default",()=>x])}]);
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,23130,4476,e=>{"use strict";let a=(0,e.i(7711).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>a],23130);var t=e.i(49982),s=e.i(77600),r=e.i(36835);function l(e){let a,l,i,o,c=(0,s.c)(10),{text:n,className:d,colors:u}=e;c[0]!==u?(a=void 0===u?["#00BFFF","#FFB6C1"]:u,c[0]=u,c[1]=a):a=c[1];let p=a;c[2]!==d?(l=(0,r.cn)("bg-clip-text text-transparent",d),c[2]=d,c[3]=l):l=c[3];let h=`linear-gradient(to right, ${p[0]}, ${p[1]})`;return c[4]!==h?(i={backgroundImage:h,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},c[4]=h,c[5]=i):i=c[5],c[6]!==l||c[7]!==i||c[8]!==n?(o=(0,t.jsx)("span",{className:l,style:i,children:n}),c[6]=l,c[7]=i,c[8]=n,c[9]=o):o=c[9],o}e.s(["GradientText",()=>l],4476)},48966,e=>{"use strict";let a=(0,e.i(7711).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],48966)},90047,61480,e=>{"use strict";let a=(0,e.i(7711).default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);e.s(["Camera",()=>a],90047);var t=e.i(23995);e.s(["ProfileService",0,{getProfile:async e=>await (0,t.safeSupabaseOperation)(async a=>{let{data:t,error:s}=await a.from("profiles").select("*").eq("id",e).single();return s?{data:null,error:s.message}:{data:t,error:null}}),updateProfile:async(e,a)=>await (0,t.safeSupabaseOperation)(async t=>{let{error:s}=await t.from("profiles").update(a).eq("id",e);return{error:s?.message||null}}),searchProfiles:async e=>await (0,t.safeSupabaseOperation)(async a=>{let{data:t,error:s}=await a.from("profiles").select("*").or(`username.ilike.%${e}%,full_name.ilike.%${e}%`).limit(20);return s?{data:[],error:s.message}:{data:t,error:null}}),uploadAvatar:async(e,a)=>await (0,t.safeSupabaseOperation)(async t=>{try{console.log("[ProfileService] Starting upload for file:",a.name);let s=a.name.split(".").pop()||"jpg",r=`${e}_${Date.now()}.${s}`,l=`avatars/${r}`,{error:i}=await t.storage.from("gossip-avatars").upload(l,a,{contentType:a.type,upsert:!1});if(i)throw console.error("[ProfileService] Upload error:",i),i;let{data:o}=t.storage.from("gossip-avatars").getPublicUrl(l);return console.log("[ProfileService] Upload successful, URL:",o.publicUrl),{data:o.publicUrl,error:null}}catch(e){return console.error("[ProfileService] Upload failed:",e),{data:null,error:e.message}}}),updatePushToken:async(e,a)=>await (0,t.safeSupabaseOperation)(async t=>{let{error:s}=await t.from("profiles").update({push_token:a}).eq("id",e);return s&&console.error("[ProfileService] Update Token Error:",s),{error:s?.message||null}})}],61480)},63078,e=>{"use strict";var a=e.i(49982),t=e.i(32758),s=e.i(66635),r=e.i(48966),l=e.i(23130),i=e.i(90047),o=e.i(76845),c=e.i(18409),n=e.i(4476),d=e.i(72013),u=e.i(61480),p=e.i(89934);function h(){let{statuses:e,loading:h,uploadStatus:m,refreshStatuses:x}=(0,t.useStatus)(),{user:f}=(0,s.useAuth)(),{addToast:g}=(0,p.useToast)(),[b,v]=(0,d.useState)(null),[w,j]=(0,d.useState)(0),[N,y]=(0,d.useState)(0),[k,S]=(0,d.useState)(!1),F=(0,d.useRef)(null),P=Object.values(e.reduce((e,a)=>{let t=a.user_id;return e[t]||(e[t]={user:a.profiles,items:[]}),e[t].items.push(a),e},{}));(0,d.useEffect)(()=>{let e;return b&&(y(0),e=setInterval(()=>{y(e=>{if(e>=100)if(w<b.items.length-1)return j(w+1),0;else return v(null),0;return e+1})},50)),()=>clearInterval(e)},[b,w]);let C=async e=>{let a=e.target.files?.[0];if(a){S(!0);try{if(!f)throw Error("Not authenticated");let{data:e,error:t}=await u.ProfileService.uploadAvatar(f.id,a);if(t)throw Error(t);e&&(await m(e,""),g("Whisper posted!","success"),x())}catch(e){g(e.message||"Failed to post whisper","error")}finally{S(!1)}}},T=e=>{switch(e?.toLowerCase()){case"male":return"#00BFFF";case"female":return"#FFB6C1";case"other":return"#FFD700";default:return"#FFF"}};return(0,a.jsxs)("div",{className:"flex-1 flex flex-col bg-black h-full relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-secondary/10 rounded-full blur-[150px] pointer-events-none"}),(0,a.jsxs)("header",{className:"p-8 pb-4 flex items-center justify-between relative z-10",children:[(0,a.jsx)("div",{className:"flex items-center gap-6",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(n.GradientText,{text:"Whispers",className:"text-5xl font-black italic uppercase tracking-tighter"}),(0,a.jsx)("div",{className:"w-16 h-16 relative",children:(0,a.jsx)("img",{src:"/gossip_illustration.png",alt:"Whispers",className:"w-full h-full object-contain opacity-80"})})]}),(0,a.jsx)("p",{className:"text-white/30 text-xs font-bold uppercase tracking-[0.2em] mt-1",children:"Disappearing stories of your circle."})]})}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{onClick:()=>F.current?.click(),disabled:k,className:"p-5 bg-white/5 border border-white/10 rounded-[24px] hover:bg-white/10 transition-all text-white disabled:opacity-50",children:k?(0,a.jsx)(l.Loader2,{className:"w-8 h-8 animate-spin"}):(0,a.jsx)(i.Camera,{className:"w-8 h-8"})}),(0,a.jsx)("input",{type:"file",ref:F,className:"hidden",accept:"image/*",onChange:C})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-8 pt-4 relative z-10",children:h&&!k?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(l.Loader2,{className:"w-10 h-10 animate-spin text-secondary"})}):(0,a.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[(0,a.jsxs)("div",{onClick:()=>F.current?.click(),className:"aspect-[3/4] rounded-[40px] bg-white/5 border border-dashed border-white/20 flex flex-col items-center justify-center gap-4 hover:border-secondary transition-all cursor-pointer group active:scale-95",children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-[30px] bg-secondary/20 flex items-center justify-center text-secondary group-hover:scale-110 transition-all",children:(0,a.jsx)(r.Plus,{className:"w-10 h-10"})}),(0,a.jsx)("span",{className:"text-[10px] font-black uppercase tracking-widest text-white/30 group-hover:text-secondary transition-colors",children:"Post Whisper"})]}),P.map(e=>(0,a.jsxs)("div",{onClick:()=>{v(e),j(0),y(0)},className:"aspect-[3/4] rounded-[40px] relative overflow-hidden border border-white/10 hover:border-secondary transition-all cursor-pointer group",children:[(0,a.jsx)("img",{src:e.items[0].media_url,alt:"",className:"absolute inset-0 w-full h-full object-cover group-hover:scale-110 duration-700 transition-all"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/20 to-transparent"}),(0,a.jsx)("div",{className:"absolute top-6 left-6 right-6 flex gap-2",children:e.items.map((e,t)=>(0,a.jsx)("div",{className:"h-1 flex-1 bg-white/30 rounded-full overflow-hidden",children:0===t&&(0,a.jsx)("div",{className:"h-full bg-secondary w-full"})},t))}),(0,a.jsxs)("div",{className:"absolute bottom-6 left-6 flex items-center gap-3",children:[(0,a.jsx)("div",{className:"relative p-1 rounded-full border-2 border-secondary bg-black ring-4 ring-black",children:(0,a.jsx)(c.Avatar,{src:e.user.avatar_url,fallback:e.user.username?.[0]||"?",className:"w-10 h-10"})}),(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("p",{className:"text-[14px] font-black uppercase text-white tracking-tight truncate italic",style:{color:T(e.user.gender)},children:e.user.username}),(0,a.jsx)("p",{className:"text-[9px] font-bold text-white/50 uppercase tracking-widest",children:new Date(e.items[0].created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})]},e.user.id))]})}),b&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black z-[100] flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"relative w-full max-w-lg aspect-[9/16] rounded-[40px] overflow-hidden bg-white/5 shadow-2xl animate-in zoom-in duration-300",children:[(0,a.jsx)("img",{src:b.items[w].media_url,alt:"",className:"absolute inset-0 w-full h-full object-contain md:object-cover"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-black/60 pointer-events-none"}),(0,a.jsx)("div",{className:"absolute top-8 left-8 right-8 flex gap-2 z-20",children:b.items.map((e,t)=>(0,a.jsxs)("div",{className:"h-1 flex-1 bg-white/20 rounded-full overflow-hidden",children:[t<w&&(0,a.jsx)("div",{className:"h-full bg-white w-full"}),t===w&&(0,a.jsx)("div",{className:"h-full bg-white transition-all duration-50",style:{width:`${N}%`}})]},t))}),(0,a.jsxs)("div",{className:"absolute top-14 left-8 right-8 flex items-center justify-between z-20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(c.Avatar,{src:b.user.avatar_url,fallback:b.user.username[0],className:"w-12 h-12 ring-2 ring-white/50"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-white font-black italic uppercase tracking-tight",style:{color:T(b.user.gender)},children:b.user.username}),(0,a.jsx)("p",{className:"text-white/50 text-[10px] uppercase font-bold tracking-widest",children:new Date(b.items[w].created_at).toLocaleTimeString()})]})]}),(0,a.jsx)("button",{onClick:()=>v(null),className:"p-3 bg-black/20 hover:bg-black/40 rounded-full backdrop-blur-xl border border-white/10 text-white transition-all",children:(0,a.jsx)(o.X,{className:"w-6 h-6"})})]}),b.items[w].caption&&(0,a.jsx)("div",{className:"absolute bottom-16 left-8 right-8 z-20 text-center",children:(0,a.jsx)("p",{className:"text-white text-lg font-bold drop-shadow-lg",children:b.items[w].caption})}),(0,a.jsxs)("div",{className:"absolute inset-x-0 top-32 bottom-32 flex z-10",children:[(0,a.jsx)("div",{className:"flex-1 hover:bg-white/5 transition-all cursor-pointer",onClick:()=>{w>0&&(j(w-1),y(0))}}),(0,a.jsx)("div",{className:"flex-1 hover:bg-white/5 transition-all cursor-pointer",onClick:()=>{w<b.items.length-1?(j(w+1),y(0)):v(null)}})]})]})})]})}e.s(["default",()=>h])}]);